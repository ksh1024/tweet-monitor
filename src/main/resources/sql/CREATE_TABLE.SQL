
CREATE TABLE KEYWORDS (
           ID INT PRIMARY KEY AUTO_INCREMENT COMMENT 'PK',
           KEYWORD_TEXT VARCHAR(255) UNIQUE NOT NULL COMMENT '모니터링할 키워드',
           IS_ACTIVE BOOLEAN DEFAULT TRUE NOT NULL COMMENT '키워드 활성화 상태 (TRUE: 모니터링 대상, FALSE: 비활성화)',
           CREATED_AT DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT 'CREATED_AT',
           UPDATED_AT DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'UPDATED_AT'
) COMMENT = '모니터링할 키워드';

CREATE TABLE RECIPIENTS (
           ID INT PRIMARY KEY AUTO_INCREMENT COMMENT '수신자 PK',
           TWITTER_USER_ID BIGINT UNIQUE NOT NULL COMMENT '트위터에서 부여한 수신자 계정 고유 ID',
           TWITTER_SCREEN_NAME VARCHAR(50) COMMENT '수신자 계정 @사용자명 (참고용)',
           DESCRIPTION VARCHAR(255) COMMENT '메모',
           IS_ACTIVE BOOLEAN DEFAULT TRUE NOT NULL COMMENT '수신자 활성화 상태 (TRUE: DM 수신 대상, FALSE: 비활성화)',
           CREATED_AT DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT 'CREATED_AT',
           UPDATED_AT DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'UPDATED_AT'
) COMMENT = 'DM 수신할 계정';

-- KEYWORDS 테이블과 RECIPIENTS 테이블의 다대다(N:M) 관계를 연결하는 중간 테이블
CREATE TABLE KEYWORD_RECIPIENT_MAP (
           KEYWORD_ID INT NOT NULL COMMENT 'KEYWORDS 테이블의 ID를 참조하는 외래키',
           RECIPIENT_ID INT NOT NULL COMMENT 'RECIPIENTS 테이블의 ID를 참조하는 외래키',
           PRIMARY KEY (KEYWORD_ID, RECIPIENT_ID) COMMENT '키워드 ID와 수신자 ID의 복합 기본키',
           FOREIGN KEY (KEYWORD_ID) REFERENCES KEYWORDS(ID) ON DELETE CASCADE,
           FOREIGN KEY (RECIPIENT_ID) REFERENCES RECIPIENTS(ID) ON DELETE CASCADE
) COMMENT = '키워드와 수신자 간의 매핑 정보';

CREATE TABLE PROCESSED_TWEETS (
           ID BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT '처리 기록 PK',
           TWEET_ID BIGINT UNIQUE NOT NULL COMMENT '트윗 고유 ID',
           MATCHED_KEYWORD_ID INT NOT NULL COMMENT '어떤 키워드에 매칭되어 처리되었는지 기록',
           PROCESSED_AT DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '트윗 처리된 시점',
           FOREIGN KEY (MATCHED_KEYWORD_ID) REFERENCES KEYWORDS(ID)
) COMMENT = '이미 처리된 트윗 기록 (중복 전송 방지)';